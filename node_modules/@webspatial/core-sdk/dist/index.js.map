{"version":3,"sources":["../src/core/private/remote-command/RemoteCommand.ts","../src/core/private/WebSpatial.ts","../src/core/SpatialObject.ts","../src/core/SpatialTransform.ts","../src/core/SpatialEntity.ts","../src/core/component/SpatialComponent.ts","../src/core/SpatialWindowContainer.ts","../src/core/resource/SpatialMeshResource.ts","../src/core/resource/SpatialPhysicallyBasedMaterialResource.ts","../src/core/SpatialSession.ts","../src/core/Spatial.ts","../src/core/SpatialHelper.ts","../src/core/component/SpatialWindowComponent.ts","../src/core/component/EventSpatialComponent.ts","../src/core/component/SpatialInputComponent.ts","../src/core/component/SpatialModelComponent.ts","../src/core/component/SpatialViewComponent.ts","../src/core/component/SpatialModel3DComponent.ts"],"sourcesContent":["export class RemoteCommand {\n  private static requestCounter = 0\n\n  command: string\n\n  data: any\n\n  requestID: number\n\n  constructor(cmd: string, data?: any) {\n    this.command = cmd\n    this.data = data\n    this.requestID = ++RemoteCommand.requestCounter\n  }\n}\n","import { RemoteCommand } from './remote-command'\nimport {\n  WindowStyle,\n  WindowContainerOptions,\n  LoadingMethodKind,\n  sceneDataShape,\n  sceneDataJSBShape,\n} from '../types'\n\ndeclare global {\n  interface Window {\n    // Location for webspatial custom functions\n    __WebSpatialData: {\n      androidNativeMessage: Function\n      getNativeVersion: Function\n    }\n\n    // Location for webspatial internal callbacks (eg. completion events)\n    __SpatialWebEvent: Function\n\n    // Used to access webkit specific api\n    webkit: any\n\n    // Marks the page as unloaded so it doesn't send additional events\n    __WebSpatialUnloaded: boolean\n\n    // Internal id information mapping to internal state about the native window\n    _webSpatialID: string\n    _webSpatialGroupID: string\n    _webSpatialParentGroupID: string\n\n    // Will be removed in favor of __WebSpatialData\n    WebSpatailNativeVersion: string\n  }\n}\n\nexport class WindowContainer {\n  id = ''\n}\n\nexport class WebSpatialResource {\n  id = ''\n  windowContainerId = ''\n  data = {} as any\n\n  receiveEvent() {}\n}\n\nexport class WebSpatial {\n  public static eventPromises: any = {}\n\n  public static transactionStarted = false\n  public static transactionCommands = Array<RemoteCommand>()\n\n  // store event receivers\n  private static eventReceivers: { [resourceId: string]: (data: any) => void } =\n    {}\n\n  public static registerEventReceiver(\n    resourceId: string,\n    callback: (data: any) => void,\n  ) {\n    this.eventReceivers[resourceId] = callback\n  }\n\n  public static unregisterEventReceiver(resourceId: string) {\n    delete this.eventReceivers[resourceId]\n  }\n\n  static init() {\n    window.__SpatialWebEvent = (e: any) => {\n      if (e.resourceId) {\n        var callback = WebSpatial.eventReceivers[e.resourceId]\n        callback(e.data)\n      } else {\n        var p = WebSpatial.eventPromises[e.requestID]\n        if (p) {\n          if (e.success) {\n            p.res(e)\n          } else {\n            p.rej(e)\n          }\n        }\n      }\n    }\n  }\n\n  static startTransaction() {\n    WebSpatial.transactionStarted = true\n    WebSpatial.transactionCommands = []\n  }\n\n  static async sendTransaction() {\n    WebSpatial.transactionStarted = false\n    var cmd = new RemoteCommand('multiCommand', {\n      commandList: WebSpatial.transactionCommands,\n    })\n\n    var result = await new Promise((res, rej) => {\n      WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n      WebSpatial.sendCommand(cmd)\n    })\n    return result\n  }\n\n  static getBackend() {\n    if (window.webkit) {\n      return 'AVP'\n    } else {\n      return 'UNKNOWN'\n    }\n  }\n\n  static async sendCommand(cmd: RemoteCommand) {\n    if (window.__WebSpatialUnloaded) {\n      return\n    }\n    if (WebSpatial.transactionStarted) {\n      WebSpatial.transactionCommands.push(cmd as any)\n      return\n    }\n\n    var msg = JSON.stringify(cmd)\n\n    if (WebSpatial.getBackend() == 'AVP') {\n      window.webkit.messageHandlers.bridge.postMessage(msg)\n      return\n    } else {\n      window.__WebSpatialData.androidNativeMessage(msg)\n      return\n    }\n  }\n\n  static getImmersiveWindowContainer() {\n    var wg = new WindowContainer()\n    wg.id = 'Immersive'\n    return wg\n  }\n\n  static getCurrentWindowContainer() {\n    var wg = new WindowContainer()\n    wg.id = 'current'\n    return wg\n  }\n\n  static getCurrentWebPanel() {\n    var wg = new WebSpatialResource()\n    wg.id = 'current'\n    wg.windowContainerId = WebSpatial.getCurrentWindowContainer().id\n    return wg\n  }\n\n  static async createScene(\n    style: WindowStyle = 'Plain',\n    cfg: {\n      sceneData: sceneDataShape\n    },\n  ) {\n    const { window: newWindow, ...sceneData } = cfg.sceneData\n    const jsbSceneData: sceneDataJSBShape = {\n      ...sceneData,\n      windowID: newWindow._webSpatialID,\n      windowContainerID: newWindow._webSpatialGroupID,\n    }\n    var cmd = new RemoteCommand('createScene', {\n      windowStyle: style,\n      sceneData: jsbSceneData,\n      windowContainerID: window._webSpatialParentGroupID, // parent WindowContainerID\n    })\n\n    try {\n      await new Promise((res, rej) => {\n        WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n        WebSpatial.sendCommand(cmd)\n      })\n      return true\n    } catch (error) {\n      return false\n    }\n  }\n\n  static async createWindowContainer(\n    style: WindowStyle = 'Plain',\n    windowContainer: WindowContainer | null,\n    parentWebView: WebSpatialResource | null,\n  ) {\n    var cmd = new RemoteCommand('createWindowContainer', {\n      windowStyle: style,\n      windowContainerID: windowContainer ? windowContainer.id : undefined,\n      resourceID: parentWebView ? parentWebView.id : undefined,\n    })\n\n    var result = await new Promise((res, rej) => {\n      WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n      WebSpatial.sendCommand(cmd)\n    })\n    var res = new WindowContainer()\n    res.id = (result as any).data.createdID\n    return res\n  }\n\n  static async destroyResource(resource: WebSpatialResource) {\n    const data = {}\n    var cmd = new RemoteCommand('destroyResource', {\n      windowContainerID: resource.windowContainerId,\n      resourceID: resource.id,\n    })\n\n    WebSpatial.sendCommand(cmd)\n  }\n\n  static async ping(msg: string) {\n    var cmd = new RemoteCommand('ping', {\n      windowContainerID: this.getCurrentWindowContainer().id,\n      resourceID: this.getCurrentWebPanel().id,\n      message: msg,\n    })\n\n    if (WebSpatial.transactionStarted) {\n      WebSpatial.sendCommand(cmd)\n      return null\n    } else {\n      var result = await new Promise((res, rej) => {\n        WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n        WebSpatial.sendCommand(cmd)\n      })\n      return result\n    }\n  }\n\n  static async getStats() {\n    var cmd = new RemoteCommand('getStats', {\n      windowContainerID: this.getCurrentWindowContainer().id,\n      resourceID: this.getCurrentWebPanel().id,\n    })\n\n    var result = await new Promise((res, rej) => {\n      WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n      WebSpatial.sendCommand(cmd)\n    })\n    return (result as any).data\n  }\n\n  static async inspect(spatialObjectId: string) {\n    var cmd = new RemoteCommand('inspect', {\n      resourceID: spatialObjectId,\n    })\n\n    var result = await new Promise((res, rej) => {\n      WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n      WebSpatial.sendCommand(cmd)\n    })\n\n    return (result as any).data\n  }\n\n  static async inspectRootWindowContainer() {\n    return this.inspect('root')\n  }\n\n  static async setComponent(\n    entity: WebSpatialResource,\n    resource: WebSpatialResource,\n  ) {\n    var cmd = new RemoteCommand('setComponent', {\n      windowContainerID: entity.windowContainerId,\n      resourceID: resource.id,\n      entityID: entity.id,\n    })\n\n    WebSpatial.sendCommand(cmd)\n  }\n\n  static async removeComponent(\n    entity: WebSpatialResource,\n    resource: WebSpatialResource,\n  ) {\n    var cmd = new RemoteCommand('removeComponent', {\n      windowContainerID: entity.windowContainerId,\n      resourceID: resource.id,\n      entityID: entity.id,\n    })\n\n    WebSpatial.sendCommand(cmd)\n  }\n\n  // windowContainer is the group the resource will be tied to (if not provided it will use the current window grou)\n  // parentWebView is the SpatialWebView that the resource will be tied to (if not provided, resource will continue to exist even if this page is unloaded)\n  static async createResource(\n    type: string,\n    windowContainer: WindowContainer | null,\n    parentWebView: WebSpatialResource | null,\n    params = {} as any,\n  ) {\n    var cmd = new RemoteCommand('createResource', {\n      windowContainerID: windowContainer ? windowContainer.id : undefined,\n      resourceID: parentWebView ? parentWebView.id : undefined,\n      type: type,\n      params: params,\n    })\n\n    var result = await new Promise((res, rej) => {\n      WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n      WebSpatial.sendCommand(cmd)\n    })\n    var res = new WebSpatialResource()\n    res.id = (result as any).data.createdID\n    res.windowContainerId = cmd.data.windowContainerID\n    return res\n  }\n\n  static async updateWindowContainer(wg: WindowContainer, data: any) {\n    var cmd = new RemoteCommand('updateWindowContainer', {\n      windowContainerID: wg.id,\n      update: data,\n    })\n\n    var result = await new Promise((res, rej) => {\n      WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n      WebSpatial.sendCommand(cmd)\n    })\n    return result\n  }\n\n  static async updateResource(resource: WebSpatialResource, data: any = null) {\n    var cmd = new RemoteCommand('updateResource', {\n      windowContainerID: resource.windowContainerId,\n      resourceID: resource.id,\n      update: data || resource.data,\n    })\n\n    var result = await new Promise((res, rej) => {\n      WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n      WebSpatial.sendCommand(cmd)\n    })\n    return result\n  }\n\n  static async setLoading(method: LoadingMethodKind, style?: string) {\n    var cmd = new RemoteCommand('setLoading', {\n      windowContainerID: window._webSpatialParentGroupID, // parent WindowContainerID\n      loading: {\n        method,\n        style,\n      },\n    })\n\n    var result = await new Promise((res, rej) => {\n      WebSpatial.eventPromises[cmd.requestID] = { res: res, rej: rej }\n      WebSpatial.sendCommand(cmd)\n    })\n    return result\n  }\n\n  static async openImmersiveSpace() {\n    var cmd = new RemoteCommand('openImmersiveSpace')\n    await WebSpatial.sendCommand(cmd)\n  }\n\n  static async dismissImmersiveSpace() {\n    var cmd = new RemoteCommand('dismissImmersiveSpace')\n    await WebSpatial.sendCommand(cmd)\n  }\n\n  static onFrame(fn: (curTime: number) => Promise<any>) {\n    var dt = 0\n    var loop = async () => {\n      var curTime = window.performance.now()\n      await fn(curTime)\n      var updateTime = window.performance.now() - curTime\n\n      // Call update loop targetting 60 fps\n      setTimeout(\n        () => {\n          loop()\n        },\n        Math.max(1000 / 60 - updateTime, 0),\n      )\n    }\n    loop()\n  }\n}\nWebSpatial.init()\n","import { WebSpatial } from './private/WebSpatial'\nimport { WebSpatialResource } from './private/WebSpatial'\n\n/**\n * @hidden\n * Parent class of spatial objects, should not be used directly\n */\nexport class SpatialObject {\n  /** @hidden */\n  constructor(\n    /** @hidden */\n    public _resource: WebSpatialResource,\n  ) {}\n\n  /**\n   * Marks resource to be released (it should no longer be used)\n   */\n  async destroy() {\n    await WebSpatial.destroyResource(this._resource)\n    await this.onDestroy()\n  }\n\n  public name: string = ''\n\n  protected async onDestroy() {}\n}\n","export class Vec3 {\n  constructor(\n    public x = 0,\n    public y = 0,\n    public z = 0,\n  ) {}\n}\n\nexport class Vec4 {\n  constructor(\n    public x = 0,\n    public y = 0,\n    public z = 0,\n    public w = 1,\n  ) {}\n}\n\n/**\n * Transform containing position, orientation and scale\n */\nexport class SpatialTransform {\n  position = new Vec3(0, 0, 0)\n  /** Quaternion value for x,y,z,w */\n  orientation = new Vec4(0, 0, 0, 1)\n  scale = new Vec3(1, 1, 1)\n}\n","import { SpatialObject } from './SpatialObject'\nimport { SpatialTransform } from './SpatialTransform'\nimport { SpatialWindowContainer } from './SpatialWindowContainer'\nimport { WebSpatial } from './private/WebSpatial'\nimport { SpatialComponent } from './component'\n\n/**\n * Entity used to describe an object that can be added to the scene\n */\nexport class SpatialEntity extends SpatialObject {\n  /**\n   * Transform corresponding to the entity\n   * note: updateTransform must be called for transform to be synced to rendering\n   */\n  transform = new SpatialTransform()\n\n  /** @hidden */\n  private _destroyed = false\n  /** @hidden */\n  private get _entity() {\n    return this._resource\n  }\n\n  /**\n   * Syncs the transform with the renderer, must be called to observe updates\n   */\n  async updateTransform() {\n    await WebSpatial.updateResource(this._entity, this.transform)\n  }\n\n  /**\n   * Syncs the zIndex with the renderer\n   */\n  async updateZIndex(zIndex: number) {\n    await WebSpatial.updateResource(this._entity, { zIndex })\n  }\n\n  private components: Map<Function, SpatialComponent> = new Map()\n\n  /**\n   * Attaches a component to the entity to be displayed\n   * [TODO] review pass by value vs ref and ownership model for this\n   */\n  async setComponent(component: SpatialComponent) {\n    await WebSpatial.setComponent(this._entity, component._resource)\n    this.components.set(component.constructor, component)\n  }\n\n  /**\n   * Removes a component from the entity\n   */\n  async removeComponent<T extends SpatialComponent>(\n    type: new (...args: any[]) => T,\n  ) {\n    var c = this.getComponent(type)\n    if (c != undefined) {\n      await WebSpatial.removeComponent(this._entity, c._resource)\n      this.components.delete(c.constructor)\n    }\n  }\n\n  /**\n   * Gets a component from the entity\n   */\n  getComponent<T extends SpatialComponent>(\n    type: new (...args: any[]) => T,\n  ): T | undefined {\n    return this.components.get(type) as T | undefined\n  }\n\n  /**\n   * @hidden\n   * Sets the window container that this entity should be rendered by (this does not effect resource ownership)\n   * @param wg the window container that should render this entity\n   */\n  async _setParentWindowContainer(wg: SpatialWindowContainer) {\n    await WebSpatial.updateResource(this._entity, {\n      setParentWindowContainerID: wg._wg.id,\n    })\n  }\n\n  /**\n   * Sets a parent entity, if that entity or its parents are attached to a window container, this entity will be displayed\n   * @param e parent entity or null to remove current parent\n   */\n  async setParent(e: SpatialEntity | null) {\n    await WebSpatial.updateResource(this._entity, {\n      setParent: e ? e._entity.id : '',\n    })\n  }\n\n  /**\n   * Sets the coordinate space of this entity (Default: App)\n   * \"App\" = game engine style coordinates in meters\n   * \"Dom\" = Windowing coordinates in dom units (eg. 0,0,0 is top left of window)\n   * \"Root\" = Coordinate space is ignored and content is displayed and updated as window container's root object, window containers can only have one root entity\n   * [TODO] review this api\n   * @param space coordinate space mode\n   */\n  async setCoordinateSpace(space: 'App' | 'Dom' | 'Root') {\n    await WebSpatial.updateResource(this._entity, { setCoordinateSpace: space })\n  }\n\n  /**\n   * Query the 3d boudning box of the entity\n   * @returns The bounding box of the entity\n   */\n  async getBoundingBox() {\n    var res: any = await WebSpatial.updateResource(this._entity, {\n      getBoundingBox: true,\n    })\n    return res.data as {\n      center: { x: number; y: number; z: number }\n      extents: { x: number; y: number; z: number }\n    }\n  }\n\n  /**\n   * Sets if the entity should be visible (default: True)\n   * @param visible\n   */\n  async setVisible(visible: boolean) {\n    await WebSpatial.updateResource(this._entity, { visible })\n  }\n\n  /**\n   * Removes a reference to the entity by the renderer and this object should no longer be used. [TODO] Attached components will not be destroyed\n   */\n  async destroy() {\n    this._destroyed = true\n    await WebSpatial.destroyResource(this._entity)\n  }\n\n  /**\n   * Check if destroy has been called\n   */\n  isDestroyed() {\n    return this._destroyed\n  }\n\n  // Set Entity name. Currently for debugging only.\n  /** @hidden */\n  async _setName(name: string) {\n    this.name = name\n    return WebSpatial.updateResource(this._entity, { name })\n  }\n}\n","import { WebSpatial, WebSpatialResource } from '../private/WebSpatial'\nimport { SpatialEntity } from '../SpatialEntity'\nimport { SpatialObject } from '../SpatialObject'\n\n/** @hidden */\nexport class SpatialComponent extends SpatialObject {\n  /**\n   * Gets the entity this component is attached to\n   * @returns entity or null\n   */\n  async getEntity() {\n    let reqResp: any = await WebSpatial.updateResource(\n      WebSpatial.getCurrentWebPanel(),\n      { getEntityID: '' },\n    )\n    if (reqResp.data.parentID === '') {\n      return new Promise<SpatialEntity | null>((res, rej) => {\n        res(null)\n      })\n    } else {\n      var res = new WebSpatialResource()\n      res.id = reqResp.data.parentID\n      return new SpatialEntity(res)\n    }\n  }\n}\n","import {\n  WebSpatial,\n  WebSpatialResource,\n  WindowContainer,\n} from './private/WebSpatial'\nimport { SpatialEntity } from './SpatialEntity'\n\n/**\n * Anchored window managed by the OS\n */\nexport class SpatialWindowContainer {\n  /** @hidden */\n  constructor(\n    /** @hidden */\n    public _wg: WindowContainer,\n  ) {}\n  /**\n   * @hidden\n   * Sets sets the open configuration for opening new window containers\n   * @param options style options\n   */\n  async _setOpenSettings(options: {\n    resolution: { width: number; height: number }\n  }) {\n    await WebSpatial.updateWindowContainer(this._wg, {\n      nextOpenSettings: options,\n    })\n  }\n\n  /**\n   * Retrieves the root entity of the windowContainer\n   * @returns the root entity of the windowContainer if one exists\n   */\n  async getRootEntity() {\n    let reqResp: any = await WebSpatial.updateWindowContainer(this._wg, {\n      getRootEntityID: '',\n    })\n    if (reqResp.data.rootEntId === '') {\n      return null\n    } else {\n      var res = new WebSpatialResource()\n      res.id = reqResp.data.rootEntId\n      return new SpatialEntity(res)\n    }\n  }\n  /*\n   * Sets the root entity that this windowContainer will display (this does not effect resource ownership)\n   * @param entity to display\n   */\n  async setRootEntity(entity: SpatialEntity) {\n    await entity._setParentWindowContainer(this)\n  }\n\n  async close() {\n    await WebSpatial.updateWindowContainer(this._wg, {\n      close: true,\n    })\n  }\n}\n","import { SpatialObject } from '../SpatialObject'\n\n/**\n * Mesh asset containing geometry\n */\nexport class SpatialMeshResource extends SpatialObject {}\n","import { SpatialModelComponent } from '../component'\nimport { WebSpatial } from '../private/WebSpatial'\nimport { SpatialObject } from '../SpatialObject'\n\n/**\n * PBR material which can be set on a SpatialModelComponent\n */\nexport class SpatialPhysicallyBasedMaterialResource extends SpatialObject {\n  /**\n   * Base color of the material containing rgba between 0 and 1\n   */\n  baseColor = { r: 0.0, g: 0.7, b: 0.7, a: 1.0 }\n  /**\n   * PBR metalic value between 0 and 1\n   */\n  metallic = { value: 0.5 }\n  /**\n   * PBR roughness value between 0 and 1\n   */\n  roughness = { value: 0.5 }\n\n  _modelComponentAttachedTo: { [key: string]: SpatialModelComponent } = {}\n  _addToComponent(c: SpatialModelComponent) {\n    this._modelComponentAttachedTo[c._resource.id] = c\n  }\n\n  /**\n   * Syncs state of color, metallic, roupghness to the renderer\n   */\n  async update() {\n    await WebSpatial.updateResource(this._resource, {\n      baseColor: this.baseColor,\n      metallic: this.metallic,\n      roughness: this.roughness,\n    })\n\n    // Since realitykit's materials are structs and not references, every time we change a material, we must copy it to all of the components its attached to to observe the update\n    for (var key in this._modelComponentAttachedTo) {\n      await this._modelComponentAttachedTo[key]._syncMaterials()\n    }\n  }\n}\n","import { SpatialEntity } from './SpatialEntity'\nimport { SpatialWindowContainer } from './SpatialWindowContainer'\nimport {\n  WebSpatial,\n  WebSpatialResource,\n  WindowContainer,\n} from './private/WebSpatial'\nimport {\n  LoadingMethodKind,\n  sceneDataShape,\n  WindowContainerOptions,\n  WindowStyle,\n} from './types'\n\nimport {\n  SpatialMeshResource,\n  SpatialPhysicallyBasedMaterialResource,\n} from './resource'\nimport {\n  SpatialModelComponent,\n  SpatialInputComponent,\n  SpatialWindowComponent,\n  SpatialViewComponent,\n  SpatialModel3DComponent,\n} from './component'\nimport { RemoteCommand } from './private/remote-command'\n\ntype CreateResourceOptions = {\n  windowContainer?: SpatialWindowContainer | null\n  windowComponent?: SpatialWindowComponent | null\n}\n\n/**\n * Animation callback with timestamp\n */\ntype animCallback = (time: DOMHighResTimeStamp) => Promise<any>\n\n/**\n * Parses the resource owners of the created object. If unedfined, will use the current window container and web panel. If null the created resource will not be destroyed unless explicitly destroyed.\n * @param options\n * @returns parsed results\n */\nfunction _parseParentResources(\n  options?: CreateResourceOptions,\n): [WindowContainer | null, WebSpatialResource | null] {\n  var parentWindowContainer: WindowContainer | null = null\n  if (options?.windowContainer !== null) {\n    parentWindowContainer = options?.windowContainer\n      ? options?.windowContainer._wg\n      : WebSpatial.getCurrentWindowContainer()\n  }\n\n  var parentWindow: WebSpatialResource | null = null\n  if (options?.windowComponent !== null) {\n    parentWindow = options?.windowComponent\n      ? options?.windowComponent._resource\n      : WebSpatial.getCurrentWebPanel()\n  }\n\n  return [parentWindowContainer, parentWindow]\n}\n\n/**\n * Session use to establish a connection to the spatial renderer of the system. All resources must be created by the session\n */\nexport class SpatialSession {\n  /** @hidden */\n  _engineUpdateListeners = Array<animCallback>()\n  /** @hidden */\n  _frameLoopStarted = false\n\n  /**\n   * Add event listener callback to be called each frame\n   * @param callback callback to be called each update\n   */\n  addOnEngineUpdateEventListener(callback: animCallback) {\n    this._engineUpdateListeners.push(callback)\n\n    if (!this._frameLoopStarted) {\n      this._frameLoopStarted = true\n      WebSpatial.onFrame(async (time: number) => {\n        await Promise.all(\n          this._engineUpdateListeners.map(cb => {\n            return cb(time)\n          }),\n        )\n      })\n    }\n  }\n\n  /**\n   * Creates a Entity\n   * @returns Entity\n   */\n  async createEntity(options?: CreateResourceOptions) {\n    var [parentWindowContainer, parentWindow] = _parseParentResources(options)\n    let entity = await WebSpatial.createResource(\n      'Entity',\n      parentWindowContainer,\n      parentWindow,\n    )\n    return new SpatialEntity(entity)\n  }\n\n  /**\n   * Creates a WindowComponent\n   * [TODO] should creation of components be moved to entity? and these made private?\n   * @returns WindowComponent\n   */\n  async createWindowComponent(options?: CreateResourceOptions) {\n    var [parentWindowContainer, parentWindow] = _parseParentResources(options)\n    let entity = await WebSpatial.createResource(\n      'SpatialWebView',\n      parentWindowContainer,\n      parentWindow,\n    )\n    return new SpatialWindowComponent(entity)\n  }\n\n  /**\n   * Creates a ViewComponent used to display 3D content within the entity\n   * @returns SpatialViewComponent\n   */\n  async createViewComponent(options?: CreateResourceOptions) {\n    var [parentWindowContainer, parentWindow] = _parseParentResources(options)\n    let entity = await WebSpatial.createResource(\n      'SpatialView',\n      parentWindowContainer,\n      parentWindow,\n    )\n    return new SpatialViewComponent(entity)\n  }\n\n  /**\n   * Creates a ModelComponent used to display geometry + material of a 3D model\n   * @returns ModelComponent\n   */\n  async createModelComponent(\n    options?: { url: string } & CreateResourceOptions,\n  ) {\n    var [parentWindowContainer, parentWindow] = _parseParentResources(options)\n    var opts = undefined\n    if (options) {\n      opts = { modelURL: options.url }\n    }\n    let entity = await WebSpatial.createResource(\n      'ModelComponent',\n      parentWindowContainer,\n      parentWindow,\n      opts,\n    )\n    return new SpatialModelComponent(entity)\n  }\n\n  /**\n   * Creates a Model3DComponent\n   * @returns Model3DComponent\n   */\n  async createModel3DComponent(\n    options?: { url: string } & CreateResourceOptions,\n  ) {\n    var [parentWindowContainer, parentWindow] = _parseParentResources(options)\n    var opts = undefined\n    if (options) {\n      opts = { modelURL: options.url }\n    }\n    let entity = await WebSpatial.createResource(\n      'Model3DComponent',\n      parentWindowContainer,\n      parentWindow,\n      opts,\n    )\n    return new SpatialModel3DComponent(entity)\n  }\n\n  /**\n   * Creates a InputComponent\n   * [Experimental] Creates a InputComponent used to handle click and drag events of the entity containing a model\n   * @returns InputComponent\n   */\n  async createInputComponent(options?: CreateResourceOptions) {\n    var [parentWindowContainer, parentWindow] = _parseParentResources(options)\n    let entity = await WebSpatial.createResource(\n      'InputComponent',\n      parentWindowContainer,\n      parentWindow,\n    )\n    return new SpatialInputComponent(entity)\n  }\n\n  /**\n   * Creates a MeshResource containing geometry data\n   * @returns MeshResource\n   */\n  async createMeshResource(\n    options?: { shape?: string } & CreateResourceOptions,\n  ) {\n    var [parentWindowContainer, parentWindow] = _parseParentResources(options)\n    let entity = await WebSpatial.createResource(\n      'MeshResource',\n      parentWindowContainer,\n      parentWindow,\n      options,\n    )\n    return new SpatialMeshResource(entity)\n  }\n\n  /**\n   * Creates a PhysicallyBasedMaterial containing PBR material data\n   * @returns PhysicallyBasedMaterial\n   */\n  async createPhysicallyBasedMaterialResource(\n    options?: {} & CreateResourceOptions,\n  ) {\n    var [parentWindowContainer, parentWindow] = _parseParentResources(options)\n    let entity = await WebSpatial.createResource(\n      'PhysicallyBasedMaterial',\n      parentWindowContainer,\n      parentWindow,\n      options,\n    )\n    return new SpatialPhysicallyBasedMaterialResource(entity)\n  }\n  /**\n   * Creates a WindowContainer\n   * @returns SpatialWindowContainer\n   * */\n  async createWindowContainer(\n    options?: {\n      style: WindowStyle\n    } & CreateResourceOptions,\n  ) {\n    var style = options?.style ? options?.style : 'Plain'\n    var [parentWindowContainer, parentWindow] = _parseParentResources(options)\n    return new SpatialWindowContainer(\n      await WebSpatial.createWindowContainer(\n        style,\n        parentWindowContainer,\n        parentWindow,\n      ),\n    )\n  }\n\n  /**\n   * Creates a Scene to display content within an anchored area managed by the OS\n   * @hidden\n   * @param {WindowStyle} [style='Plain'] - The style of the Scene container to be created with. Defaults to 'Plain'.\n   * @param {Object} [cfg={}] - Configuration object for the Scene.\n   * @returns Boolean\n   */\n  async _createScene(\n    style: WindowStyle = 'Plain',\n    cfg: {\n      sceneData: sceneDataShape\n    },\n  ) {\n    return await WebSpatial.createScene(style, cfg)\n  }\n\n  /**\n   * Retrieves the window for this page\n   * @returns the window component corresponding to the js running on this page\n   * [TODO] discuss implications of this not being async\n   */\n  getCurrentWindowComponent() {\n    return new SpatialWindowComponent(WebSpatial.getCurrentWebPanel())\n  }\n\n  /**\n   * Retrieves the parent window for this page or null if this is the root page\n   * @returns the window component or null\n   */\n  async getParentWindowComponent() {\n    let parentResp: any = await WebSpatial.updateResource(\n      WebSpatial.getCurrentWebPanel(),\n      { getParentID: '' },\n    )\n    if (parentResp.data.parentID === '') {\n      return new Promise<SpatialWindowComponent | null>((res, rej) => {\n        res(null)\n      })\n    } else {\n      var res = new WebSpatialResource()\n      res.id = parentResp.data.parentID\n      return new SpatialWindowComponent(res)\n    }\n  }\n\n  /**\n   * Logs a message to the native apps console\n   * @param msg mesage to log\n   */\n  async log(...msg: any[]) {\n    await WebSpatial.sendCommand(\n      new RemoteCommand('log', {\n        logString: msg.map(x => {\n          return JSON.stringify(x)\n        }),\n      }),\n    )\n  }\n\n  /**\n   * @hidden\n   * Debugging only, used to ping the native renderer\n   */\n  async _ping(msg: string) {\n    return await WebSpatial.ping(msg)\n  }\n\n  /**\n   * @hidden\n   * Debugging to get internal state from native code\n   * @returns stats from native code. Objects tracks number of native objects that were created but not yet explicitly destroyed. RefObjects tracks bjects that still have references. After an object is destroyed, we should be cleaning up all of the native references. Expect objects.count == refObjects.count , if not, there is likely a leak.\n   */\n  async _getStats() {\n    return (await WebSpatial.getStats()) as {\n      backend: string\n      objects: { count: number }\n      refObjects: { count: number }\n    }\n  }\n\n  /**\n   * @hidden\n   */\n  async _inspect(spatialObjectId: string = WebSpatial.getCurrentWebPanel().id) {\n    return WebSpatial.inspect(spatialObjectId)\n  }\n\n  /**\n   * @hidden\n   */\n  async _inspectRootWindowContainer() {\n    return WebSpatial.inspectRootWindowContainer()\n  }\n\n  /** Opens the immersive space */\n  async openImmersiveSpace() {\n    return await WebSpatial.openImmersiveSpace()\n  }\n\n  /** Closes the immersive space */\n  async dismissImmersiveSpace() {\n    return await WebSpatial.dismissImmersiveSpace()\n  }\n\n  private static _immersiveWindowContainer =\n    null as null | SpatialWindowContainer\n  /**\n   * Retreives the window container corresponding to the Immersive space\n   * @returns the immersive window container\n   */\n  async getImmersiveWindowContainer() {\n    if (SpatialSession._immersiveWindowContainer) {\n      return SpatialSession._immersiveWindowContainer\n    } else {\n      SpatialSession._immersiveWindowContainer = new SpatialWindowContainer(\n        WebSpatial.getImmersiveWindowContainer(),\n      )\n      return SpatialSession._immersiveWindowContainer\n    }\n  }\n\n  // Retreives the window container that is the parent to this spatial web page\n  private static _currentWindowContainer = null as null | SpatialWindowContainer\n\n  /**\n   * Gets the current window container for the window\n   * [TODO] discuss what happens if it doesnt yet have a window container\n   * @returns the current window container for the window\n   */\n  getCurrentWindowContainer() {\n    if (SpatialSession._currentWindowContainer) {\n      return SpatialSession._currentWindowContainer\n    } else {\n      SpatialSession._currentWindowContainer = new SpatialWindowContainer(\n        WebSpatial.getCurrentWindowContainer(),\n      )\n      return SpatialSession._currentWindowContainer\n    }\n  }\n\n  /**\n   * Start a transaction that queues up commands to submit them all at once to reduce ipc overhead\n   * @param fn function to be run, within this function, promises will not resolve\n   * @returns promise for the entire transaction completion\n   */\n  transaction(fn: Function) {\n    WebSpatial.startTransaction()\n    fn()\n    return WebSpatial.sendTransaction()\n  }\n\n  /**\n   * Creates a window context object that is compatable with SpatialWindowComponent's setFromWindow API\n   * @returns window context\n   */\n  async createWindowContext() {\n    let openedWindow = window.open('webspatial://createWindowContext')\n    if (WebSpatial.getBackend() != 'AVP') {\n      // Currently there is a bug with webview which requires us to trigger a navigation before native code can interact with created webview\n      var counter = 0\n      while ((openedWindow!.window as any).testAPI == null) {\n        if (counter > 15) {\n          openedWindow?.close()\n          openedWindow = window.open('about:blank')\n          counter = 0\n          this.log('unexpected error when trying to open new window, retrying.')\n        }\n        var locName = 'about:blank?x' + counter\n        openedWindow!!.location.href = locName\n        counter++\n\n        await new Promise(resolve => setTimeout(resolve, 10))\n      }\n      ;(openedWindow! as any)._webSpatialID = (\n        openedWindow!.window as any\n      ).testAPI.getWindowID()\n    } else {\n      while ((openedWindow!.window as any)._webSpatialID == undefined) {\n        await new Promise(resolve => setTimeout(resolve, 10))\n      }\n    }\n    openedWindow!.document.head.innerHTML = `<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n      <base href=\"${document.baseURI}\">\n      `\n    return openedWindow\n  }\n\n  // Get Entity by id. Currently for debugging only.\n  /** @hidden */\n  async _getEntity(id: string) {\n    const entityInfo = await WebSpatial.inspect(id)\n    const [_, x, y, z] = entityInfo.position.match(/(\\d+\\.?\\d*)/g)\n    const [__, sx, sy, sz] = entityInfo.scale.match(/(\\d+\\.?\\d*)/g)\n\n    var res = new WebSpatialResource()\n    res.id = id\n    res.windowContainerId = WebSpatial.getCurrentWindowContainer().id\n    const entity = new SpatialEntity(res)\n    entity.transform.position.x = parseFloat(x)\n    entity.transform.position.y = parseFloat(y)\n    entity.transform.position.z = parseFloat(z)\n\n    entity.transform.scale.x = parseFloat(sx)\n    entity.transform.scale.y = parseFloat(sy)\n    entity.transform.scale.z = parseFloat(sz)\n\n    return entity\n  }\n  // set loading view.\n  /** @hidden */\n  async setLoading(method: LoadingMethodKind, style?: string) {\n    return WebSpatial.setLoading(method, style)\n  }\n}\n","import { SpatialSession } from './SpatialSession'\n\n/**\n * Base object designed to be placed on navigator.spatial to mirror navigator.xr for webxr\n */\nexport class Spatial {\n  /**\n   * Requests a session object from the browser\n   * @returns The session or null if not availible in the current browser\n   * [TODO] discuss implications of this not being async\n   */\n  requestSession() {\n    if (\n      this.isSupported() &&\n      this.getNativeVersion() === this.getClientVersion()\n    ) {\n      return new SpatialSession()\n    } else {\n      return null\n    }\n  }\n\n  /**\n   * @returns true if web spatial is supported by this webpage\n   */\n  isSupported() {\n    return this.getNativeVersion() === this.getClientVersion()\n  }\n\n  /**\n   * Gets the native version, format is \"x.x.x\"\n   * @returns native version string\n   */\n  getNativeVersion() {\n    if (window.__WebSpatialData && window.__WebSpatialData.getNativeVersion) {\n      return window.__WebSpatialData.getNativeVersion()\n    }\n    return window.WebSpatailNativeVersion === 'PACKAGE_VERSION'\n      ? this.getClientVersion()\n      : window.WebSpatailNativeVersion\n  }\n\n  /**\n   * Gets the client version, format is \"x.x.x\"\n   * @returns client version string\n   */\n  getClientVersion() {\n    return __WEBSPATIAL_CORE_SDK_VERSION__\n  }\n}\n","import { SpatialViewComponent, StyleParam } from './component'\nimport { Spatial } from './Spatial'\nimport { SpatialEntity } from './SpatialEntity'\nimport { SpatialSession } from './SpatialSession'\nimport { Vec3 } from './SpatialTransform'\n\n/**\n * Helper class used to quickly add spatial content to standard web pages\n * [Experimental] expect APIs to potentially change in future versions\n */\nexport class SpatialHelper {\n  private static _instance: SpatialHelper | null = null\n  static get instance() {\n    if (this._instance) {\n      return this._instance\n    } else {\n      let spatial = new Spatial()\n      if (spatial.isSupported()) {\n        let session = spatial.requestSession()\n        if (session) {\n          this._instance = new SpatialHelper(session)\n          return this._instance\n        }\n      }\n    }\n    return null\n  }\n\n  constructor(public session: SpatialSession) {}\n\n  shape = {\n    createShapeEntity: async (shape = 'box') => {\n      var box = await this.session.createMeshResource({ shape: shape })\n      var mat = await this.session.createPhysicallyBasedMaterialResource()\n      await mat.update()\n\n      var customModel = await this.session.createModelComponent()\n      customModel.setMaterials([mat])\n      customModel.setMesh(box)\n\n      var boxEntity = await this.session.createEntity()\n      await boxEntity.setComponent(customModel)\n      boxEntity.transform.position.z = 0\n      boxEntity.transform.scale = new Vec3(0.5, 0.5, 0.5)\n      await boxEntity.updateTransform()\n      return boxEntity\n    },\n    createModelEntity: async (url: string) => {\n      var customModel = await this.session.createModelComponent({ url })\n      var boxEntity = await this.session.createEntity()\n      await boxEntity.setComponent(customModel)\n      await boxEntity.updateTransform()\n      return boxEntity\n    },\n    wrapInBoundingBoxEntity: async (entityToWrap: SpatialEntity) => {\n      var bb = await entityToWrap.getBoundingBox()\n\n      // Scale to fit\n      var targetSize = 1.0\n      var scale =\n        targetSize / Math.max(bb.extents.x, bb.extents.y, bb.extents.z)\n      entityToWrap.transform.scale.x = scale\n      entityToWrap.transform.scale.y = scale\n      entityToWrap.transform.scale.z = scale\n\n      // Center within view\n      entityToWrap.transform.position.x = -bb.center.x * scale\n      entityToWrap.transform.position.y = -bb.center.y * scale\n      entityToWrap.transform.position.z = -bb.center.z * scale\n      await entityToWrap.updateTransform()\n\n      // wrap in boudning box\n      var boudningEntity = await SpatialHelper.instance?.session.createEntity()!\n      await entityToWrap.setParent(boudningEntity!)\n      return boudningEntity\n    },\n  }\n\n  navigation = {\n    openPanel: async (\n      url: string,\n      options?: { resolution: { width: number; height: number } },\n    ) => {\n      if (options?.resolution) {\n        await this.session\n          .getCurrentWindowContainer()\n          ._setOpenSettings({ resolution: options.resolution })\n      }\n\n      // Create window container\n      var wg = await this.session.createWindowContainer({\n        style: 'Plain',\n        windowComponent: null,\n        windowContainer: null,\n      })\n\n      // Create a root entity displaying a webpage\n      var ent = await this.session!.createEntity({\n        windowComponent: null,\n        windowContainer: wg,\n      })\n      var i = await this.session!.createWindowComponent({\n        windowComponent: null,\n        windowContainer: wg,\n      })\n      await i.loadURL(url)\n      await ent.setCoordinateSpace('Root')\n      await ent.setComponent(i)\n\n      // Add enitity the window container\n      await wg.setRootEntity(ent)\n\n      // Restore default size\n      await this.session\n        .getCurrentWindowContainer()\n        ._setOpenSettings({ resolution: { width: 900, height: 700 } })\n\n      return {\n        windowContainer: wg,\n      }\n    },\n    openVolume: async (\n      url: string,\n      options?: { resolution: { width: number; height: number } },\n    ) => {\n      var wg = await this.session.createWindowContainer({\n        style: 'Volumetric',\n        windowComponent: null,\n        windowContainer: null,\n      })\n\n      // Create a root view entity within the window container\n      var rootEnt = await this.session!.createEntity({\n        windowComponent: null,\n        windowContainer: wg,\n      })\n      await rootEnt.setComponent(\n        await this.session!.createViewComponent({\n          windowComponent: null,\n          windowContainer: wg,\n        }),\n      )\n      await rootEnt.setCoordinateSpace('Root')\n      await wg.setRootEntity(rootEnt)\n\n      // Add webpage to the window container\n      var ent = await this.session!.createEntity({\n        windowComponent: null,\n        windowContainer: wg,\n      })\n      var i = await this.session!.createWindowComponent({\n        windowComponent: null,\n        windowContainer: wg,\n      })\n      await i.loadURL(url)\n      if (options?.resolution) {\n        await i.setResolution(\n          options.resolution.width,\n          options.resolution.height,\n        )\n      } else {\n        await i.setResolution(1000, 1000)\n      }\n      ent.transform.position.z = -0.49\n      await ent.updateTransform()\n      await ent.setCoordinateSpace('App')\n      await ent.setComponent(i)\n      await ent.setParent(rootEnt)\n    },\n  }\n\n  dom = {\n    attachSpatialView: async (divOnPage: HTMLElement) => {\n      // Create SpatialView\n      var viewEnt = await this.session.createEntity()\n      await viewEnt.setCoordinateSpace('Dom') // Set coordinate space so its transform is relative to the webpage's pixels\n      await viewEnt.setComponent(await this.session.createViewComponent())\n\n      // Add to the root window component to display\n      var wc = await this.session.getCurrentWindowComponent()\n      var ent = await wc.getEntity()\n      await viewEnt.setParent(ent!)\n\n      // Keep spatialView positioned where the div is\n      var update = () => {\n        var rect = divOnPage.getBoundingClientRect()\n        viewEnt.transform.position.x = rect.x + rect.width / 2\n        viewEnt.transform.position.y = rect.y + rect.height / 2 + window.scrollY\n        viewEnt.updateTransform()\n        viewEnt\n          .getComponent(SpatialViewComponent)!\n          .setResolution(rect.width, rect.height)\n      }\n      var mo = new MutationObserver(update)\n      mo.observe(divOnPage, { attributes: true })\n      var ro = new ResizeObserver(update)\n      ro.observe(divOnPage)\n      const addRemoveObserver = new MutationObserver(mutations => {\n        mutations.forEach(mutation => {\n          mutation.removedNodes.forEach(node => {\n            if (node instanceof HTMLElement) {\n              update()\n            }\n          })\n          mutation.addedNodes.forEach(node => {\n            if (node instanceof HTMLElement) {\n              update()\n            }\n          })\n        })\n      })\n      addRemoveObserver.observe(document.body, {\n        childList: true,\n        subtree: true,\n      })\n      update()\n      return {\n        entity: viewEnt,\n      }\n    },\n  }\n\n  setBackgroundStyle = async (\n    style: StyleParam,\n    backgroundColor = '#00000000',\n  ) => {\n    document.documentElement.style.backgroundColor = backgroundColor\n    await this.session!.getCurrentWindowComponent().setStyle(style)\n  }\n}\n","import { SpatialComponent } from './SpatialComponent'\nimport { WebSpatial } from '../private/WebSpatial'\nimport { Vec3 } from '../SpatialTransform'\nimport { SpatialHelper } from '../SpatialHelper'\n\n/**\n * Material type for SpatialDiv or HTML document.\n *\n * This type defines the background material options for both SpatialDiv elements and HTML documents.\n *\n * - `'none'`: This is the default value.\n *   - For HTML documents, the web page window will have the default native background.\n *   - For SpatialDiv, the window will have a transparent background.\n * - `'translucent'`: Represents a glass-like material in AVP (Apple Vision Pro).\n * - `'thick'`: Represents a thick material in AVP.\n * - `'regular'`: Represents a regular material in AVP.\n * - `'thin'`: Represents a thin material in AVP.\n * - `'transparent'`: Represents a fully transparent background.\n */\nexport type BackgroundMaterialType =\n  | 'none'\n  | 'translucent'\n  | 'thick'\n  | 'regular'\n  | 'thin'\n  | 'transparent'\n\nexport type CornerRadius = {\n  topLeading: number\n  bottomLeading: number\n  topTrailing: number\n  bottomTrailing: number\n}\n\nexport type StyleParam = {\n  material?: {\n    type: BackgroundMaterialType\n  }\n  cornerRadius?: number | CornerRadius\n}\n\n/**\n * Used to position an web window in 3D space\n */\nexport class SpatialWindowComponent extends SpatialComponent {\n  /**\n   * Loads a url page in the window\n   * @param url url to load\n   */\n  async loadURL(url: string) {\n    await WebSpatial.updateResource(this._resource, { url: url })\n  }\n\n  async setFromWindow(window: any) {\n    if (window._webSpatialID) {\n      await WebSpatial.updateResource(this._resource, {\n        windowID: window._webSpatialID,\n      })\n    } else {\n      await console.warn(\n        'failed to call setFromWindow, window provided is not valid',\n      )\n    }\n  }\n\n  /**\n   * Sets the resolution of the window, the resulting dimensions when rendered will be equal to 1/1360 units\n   * eg. if the resolution is set to 1360x1360 it will be a 1x1 plane\n   * See 1360 in spatialViewUI.swift for how this ratio works\n   * @param width width in pixels\n   * @param height height in pixels\n   */\n  async setResolution(width: number, height: number) {\n    await WebSpatial.updateResource(this._resource, {\n      resolution: { x: width, y: height },\n    })\n  }\n\n  /**\n   * [Experimental] Sets the anchor which the entity this is attached to will rotate around\n   * @param rotationAnchor\n   */\n  async setRotationAnchor(rotationAnchor: Vec3) {\n    await WebSpatial.updateResource(this._resource, {\n      rotationAnchor: rotationAnchor,\n    })\n  }\n\n  /**\n   * [Experimental] Sets the opacity of the window after apply material\n   * @param opacity\n   */\n  async setOpacity(opacity: number) {\n    await WebSpatial.updateResource(this._resource, {\n      opacity,\n    })\n  }\n\n  /**\n   * Sets the style that should be applied to the window\n   * @param options style options\n   */\n  async setStyle(styleParam: StyleParam) {\n    const currentWindowComponent =\n      SpatialHelper.instance?.session.getCurrentWindowComponent()\n    const isSettingSelfStyle =\n      currentWindowComponent?._resource.id == this._resource.id\n\n    const { material, cornerRadius } = styleParam\n    const options: any = {}\n    if (material?.type) {\n      options.backgroundMaterial = material.type\n    }\n\n    if (cornerRadius !== undefined) {\n      if (typeof cornerRadius === 'number') {\n        options.cornerRadius = {\n          topLeading: cornerRadius,\n          bottomLeading: cornerRadius,\n          topTrailing: cornerRadius,\n          bottomTrailing: cornerRadius,\n        }\n      } else {\n        options.cornerRadius = { ...cornerRadius }\n      }\n    }\n\n    if (isSettingSelfStyle && document && document.readyState == 'loading') {\n      // Avoid flash of unstyled content by sending style command via a link element\n      var encoded = encodeURIComponent(JSON.stringify(options))\n\n      const a = document.createElement(`a`)\n      a.href = 'forcestyle://mystyle.css?' + 'style=' + encoded\n      document.body.appendChild(a)\n      a.click()\n      // remove this element after trigger forceStyle action\n      a.remove()\n    } else {\n      await WebSpatial.updateResource(this._resource, { style: options })\n    }\n  }\n\n  /**\n   * Modifies the amount the spatial window can be scrolled\n   * Should only be used internally\n   * See https://developer.apple.com/documentation/uikit/1624475-uiedgeinsetsmake?language=objc\n   * @param insets margin to modify scroll distances by\n   */\n  async setScrollEdgeInsets(insets: {\n    top: number\n    left: number\n    bottom: number\n    right: number\n  }) {\n    await WebSpatial.updateResource(this._resource, {\n      setScrollEdgeInsets: insets,\n    })\n  }\n\n  /**\n   * Enable/Disable scrolling in the window (defaults to enabled), if disabled, scrolling will be applied to the root page\n   * @param enabled value to set\n   */\n  async setScrollEnabled(enabled: boolean) {\n    await WebSpatial.updateResource(this._resource, { scrollEnabled: enabled })\n  }\n\n  /**\n   * Defaults to false. If set to true, scrolling the parent page will also scroll this window with it like other dom elements\n   * @param scrollWithParent value to set\n   */\n  async setScrollWithParent(scrollWithParent: boolean) {\n    await WebSpatial.updateResource(this._resource, {\n      scrollWithParent: scrollWithParent,\n    })\n  }\n}\n","import { WebSpatial, WebSpatialResource } from '../private/WebSpatial'\nimport { SpatialComponent } from './SpatialComponent'\n\n/**\n * @description\n * Represents a spatial component that handles events related to spatial interactions.\n * This class extends `SpatialComponent` and provides additional functionality for managing\n * event-driven spatial behaviors.\n *\n * @hidden\n * This class is intended for internal use and should not be exposed in the public API.\n */\nexport abstract class EventSpatialComponent extends SpatialComponent {\n  // Class implementation goes here\n  constructor(_resource: WebSpatialResource) {\n    super(_resource)\n    WebSpatial.registerEventReceiver(_resource.id, (data: any) => {\n      this.onRecvEvent(data)\n    })\n  }\n\n  /**\n   * @description\n   * Abstract method to be implemented by subclasses. Called when a spatial event is received.\n   * @param data The data associated with the received event.\n   */\n  protected abstract onRecvEvent(data: any): void\n\n  protected override async onDestroy() {\n    WebSpatial.unregisterEventReceiver(this._resource.id)\n  }\n}\n","import { Vec3 } from '../SpatialTransform'\nimport { EventSpatialComponent } from './EventSpatialComponent'\n\n/**\n * Translate event, matching similar behavior to https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/drag_event\n */\ntype TranslateEvent = {\n  eventType: 'dragstart' | 'dragend' | 'drag'\n  translate?: Vec3\n}\n/**\n * Used to handle input events on an entity\n */\nexport class SpatialInputComponent extends EventSpatialComponent {\n  protected override onRecvEvent(data: any): void {\n    this.onTranslate(data)\n  }\n\n  /**\n   * Callback fired when a translate event occurs\n   * @param data translate event data\n   */\n  public onTranslate(data: TranslateEvent) {}\n}\n","import { SpatialMeshResource } from '../resource/SpatialMeshResource'\nimport { SpatialPhysicallyBasedMaterialResource } from '../resource/SpatialPhysicallyBasedMaterialResource'\nimport { SpatialComponent } from './SpatialComponent'\nimport { WebSpatial } from '../private/WebSpatial'\n\n/**\n * Used to position a model in 3D space, made up of a mesh and materials to be applied to the mesh\n */\nexport class SpatialModelComponent extends SpatialComponent {\n  private cachedMaterials = new Array<SpatialPhysicallyBasedMaterialResource>()\n  /**\n   * Sets the mesh to be displayed by the component\n   * @param mesh mesh to set\n   */\n  async setMesh(mesh: SpatialMeshResource) {\n    await WebSpatial.updateResource(this._resource, {\n      meshResource: mesh._resource.id,\n    })\n  }\n\n  /**\n   * Sets the materials that should be applied to the mesh\n   * @param materials array of materials to set\n   */\n  async setMaterials(materials: Array<SpatialPhysicallyBasedMaterialResource>) {\n    this.cachedMaterials = materials\n    await WebSpatial.updateResource(this._resource, {\n      materials: materials.map(m => {\n        m._addToComponent(this)\n        return m._resource.id\n      }),\n    })\n  }\n\n  /** @hidden */\n  async _syncMaterials() {\n    await this.setMaterials(this.cachedMaterials)\n  }\n}\n","import { WebSpatial } from '../private/WebSpatial'\nimport { SpatialComponent } from './SpatialComponent'\n\n/**\n * Represenets a volume that can be added to the webpage\n * Child entities will be added within this volume's space\n * Defaults to having 1x1x1 meter dimensions\n * Resolution defaults to 100x100 pixels\n * Only will be displayed on entities in \"ROOT\" or \"DOM\" space\n * If the resolution of the spatial view is not a square, the volume will be larger based on the ratio with the shortest side being 1 meter.\n * (eg. 200x100 = 2m x 1m x 1m volume)\n */\nexport class SpatialViewComponent extends SpatialComponent {\n  /**\n   * Sets the resolution of the spatial view in dom pixels\n   */\n  async setResolution(width: number, height: number) {\n    await WebSpatial.updateResource(this._resource, {\n      resolution: { x: width, y: height },\n    })\n  }\n\n  /**\n   * Sets if content of the spatialView should be within a portal\n   * If true, volume will be behind the page, if false, it will be in front of the page\n   */\n  async setIsPortal(isPortal: Boolean) {\n    await WebSpatial.updateResource(this._resource, {\n      isPortal: isPortal,\n    })\n  }\n}\n","import { EventSpatialComponent } from './EventSpatialComponent'\nimport { WebSpatial } from '../private/WebSpatial'\nimport { Vec3 } from '../SpatialTransform'\n\n/**\n * Translate event, matching similar behavior to https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/drag_event\n */\nexport type SpatialModelDragEvent = {\n  eventType: 'dragstart' | 'dragend' | 'drag'\n  translation3D: Vec3\n  startLocation3D: Vec3\n}\n\nexport type TapEvent = {\n  eventType: 'tap'\n}\n\n/**\n * Used to position a model3d in 3D space\n */\nexport class SpatialModel3DComponent extends EventSpatialComponent {\n  protected override onRecvEvent(data: any): void {\n    const { eventType, value, error } = data\n    switch (eventType) {\n      case 'phase':\n        if (value === 'success') {\n          this.onSuccess?.()\n        } else {\n          this.onFailure?.(error as string)\n        }\n        break\n      case 'dragstart':\n        this._onDragStart?.(value)\n        break\n      case 'dragend':\n        this._onDragEnd?.(value)\n        break\n      case 'drag':\n        this._onDrag?.(value)\n        break\n      case 'tap':\n        this._onTap?.()\n        break\n      case 'doubletap':\n        this._onDoubleTap?.()\n        break\n      case 'longpress':\n        this._onLongPress?.()\n        break\n\n      default:\n        break\n    }\n  }\n  /**\n   * Sets the resolution of the spatial view in dom pixels\n   */\n  async setResolution(width: number, height: number) {\n    await WebSpatial.updateResource(this._resource, {\n      resolution: { x: width, y: height },\n    })\n  }\n\n  async setRotationAnchor(rotationAnchor: Vec3) {\n    await WebSpatial.updateResource(this._resource, {\n      rotationAnchor: rotationAnchor,\n    })\n  }\n\n  /**\n   * Sets the opacity of the model\n   * @param opacity\n   */\n  async setOpacity(opacity: number) {\n    await WebSpatial.updateResource(this._resource, {\n      opacity,\n    })\n  }\n\n  /**\n   * Sets how the model fill the rect\n   * @param contentMode\n   */\n  async setContentMode(contentMode: 'fill' | 'fit') {\n    await WebSpatial.updateResource(this._resource, {\n      contentMode,\n    })\n  }\n\n  /**\n   * Constrains this model dimensions to the specified aspect ratio.\n   * with a value of 0, the model will use the original aspect ratio.\n   *\n   * @param aspectRatio number\n   */\n  async setAspectRatio(aspectRatio: number) {\n    await WebSpatial.updateResource(this._resource, {\n      aspectRatio,\n    })\n  }\n\n  /**\n   * Defaults to false. If set to true, scrolling the parent page will also scroll this window with it like other dom elements\n   * @param scrollWithParent value to set\n   */\n  async setScrollWithParent(scrollWithParent: boolean) {\n    await WebSpatial.updateResource(this._resource, {\n      scrollWithParent: scrollWithParent,\n    })\n  }\n\n  /**\n   * Sets whether the model appear in original size or fit the rect\n   * @param resizable\n   */\n  async setResizable(resizable: boolean) {\n    await WebSpatial.updateResource(this._resource, {\n      resizable,\n    })\n  }\n\n  /**\n   * Callback fired when model load success\n   */\n  public onSuccess?: () => void\n\n  /**\n   * Callback fired when model load failure\n   * @param errorReason\n   */\n  public onFailure?: (errorReason: string) => void\n\n  /**\n   * Callback fired when model was dragged at the beginning\n   * @param dragEvent\n   */\n  private _onDragStart?: (dragEvent: SpatialModelDragEvent) => void\n  public set onDragStart(\n    callback: ((dragEvent: SpatialModelDragEvent) => void) | undefined,\n  ) {\n    if (this._onDragStart !== callback) {\n      this._onDragStart = callback\n      WebSpatial.updateResource(this._resource, {\n        enableDragEvent: this.enableDragEvent,\n      })\n    }\n  }\n\n  /**\n   * Callback fired when model was dragged\n   * @param dragEvent\n   */\n  private _onDrag?: (dragEvent: SpatialModelDragEvent) => void\n  public set onDrag(\n    callback: ((dragEvent: SpatialModelDragEvent) => void) | undefined,\n  ) {\n    if (this._onDrag !== callback) {\n      this._onDrag = callback\n      WebSpatial.updateResource(this._resource, {\n        enableDragEvent: this.enableDragEvent,\n      })\n    }\n  }\n\n  /**\n   * Callback fired when model was dragged at the ending\n   * @param dragEvent\n   */\n  private _onDragEnd?: (dragEvent: SpatialModelDragEvent) => void\n  public set onDragEnd(\n    callback: ((dragEvent: SpatialModelDragEvent) => void) | undefined,\n  ) {\n    if (this._onDragEnd !== callback) {\n      this._onDragEnd = callback\n      WebSpatial.updateResource(this._resource, {\n        enableDragEvent: this.enableDragEvent,\n      })\n    }\n  }\n\n  private get enableDragEvent(): boolean {\n    return (\n      undefined !== this._onDrag ||\n      undefined !== this._onDragStart ||\n      undefined !== this._onDragEnd\n    )\n  }\n\n  /**\n   * Callback fired when model was tapped\n   */\n  private _onTap?: () => void\n  public set onTap(callback: (() => void) | undefined) {\n    if (this._onTap !== callback) {\n      this._onTap = callback\n      WebSpatial.updateResource(this._resource, {\n        enableTapEvent: undefined !== callback,\n      })\n    }\n  }\n\n  /** Callback fired when model was double tapped */\n  private _onDoubleTap?: () => void\n  public set onDoubleTap(callback: (() => void) | undefined) {\n    if (this._onDoubleTap !== callback) {\n      this._onDoubleTap = callback\n      WebSpatial.updateResource(this._resource, {\n        enableDoubleTapEvent: undefined !== callback,\n      })\n    }\n  }\n\n  /** Callback fired when model was long pressed */\n  private _onLongPress?: () => void\n  public set onLongPress(callback: (() => void) | undefined) {\n    if (this._onLongPress !== callback) {\n      this._onLongPress = callback\n      WebSpatial.updateResource(this._resource, {\n        enableLongPressEvent: undefined !== callback,\n      })\n    }\n  }\n}\n"],"mappings":"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","names":["res","res","res","window"]}