{"version":3,"sources":["../src/pluginUtils.ts"],"sourcesContent":["const AVP = 'avp'\nfunction getEnv(): ModeKind {\n  const env = process.env.XR_ENV\n  return env === 'avp' ? 'avp' : undefined\n}\n\nexport type ModeKind = 'avp' | undefined\n\nexport { getEnv, AVP }\n\nexport function getFinalBase(\n  userBase: string | undefined,\n  mode: ModeKind,\n  pluginOutputDir: string = '/webspatial/avp',\n) {\n  if (mode === 'avp') {\n    if (userBase !== undefined) {\n      return userBase\n    } else {\n      return pluginOutputDir\n    }\n  }\n\n  // web version\n  return userBase\n}\n\nexport function getFinalOutdir(\n  userOutDir: string | undefined = 'dist',\n  mode: ModeKind,\n  pluginOutputDir: string = '/webspatial/avp',\n) {\n  if (mode === 'avp') {\n    pluginOutputDir = removeFirstSlash(pluginOutputDir)\n    return `${userOutDir}/${pluginOutputDir}`\n  }\n\n  // web version\n  return userOutDir\n}\n\nexport function addFirstSlash(input?: string) {\n  if (input === undefined || input.length === 0) return ''\n  if (input[0] !== '/') return '/' + input\n  return input\n}\n\nexport function removeFirstSlash(input?: string) {\n  if (input === undefined) return ''\n\n  let idx = 0\n  while (idx < input.length && input[idx] === '/') {\n    idx += 1\n  }\n  return input.slice(idx)\n}\n\nexport function getReactSDKAliasByMode(mode?: ModeKind) {\n  if (mode === 'avp') {\n    return { '@webspatial/react-sdk$': '@webspatial/react-sdk/default' }\n  }\n  return { '@webspatial/react-sdk$': '@webspatial/react-sdk/web' }\n}\n\nexport function getReactSDKAliasReplacementByMode(mode?: ModeKind) {\n  if (mode === 'avp') {\n    return {\n      find: /^@webspatial\\/react-sdk$/,\n      replacement: '@webspatial/react-sdk/default',\n    }\n  }\n  return {\n    find: /^@webspatial\\/react-sdk$/,\n    replacement: '@webspatial/react-sdk/web',\n  }\n}\n\nexport function getJSXAliasByMode(mode?: ModeKind) {\n  if (mode === 'avp') {\n    return {\n      '@webspatial/react-sdk/jsx-dev-runtime':\n        '@webspatial/react-sdk/default/jsx-dev-runtime',\n      '@webspatial/react-sdk/jsx-runtime':\n        '@webspatial/react-sdk/default/jsx-runtime',\n    }\n  }\n  return {\n    '@webspatial/react-sdk/jsx-dev-runtime':\n      '@webspatial/react-sdk/web/jsx-dev-runtime',\n    '@webspatial/react-sdk/jsx-runtime':\n      '@webspatial/react-sdk/web/jsx-runtime',\n  }\n}\n\nexport function getJSXImportSourceByMode(mode?: ModeKind) {\n  if (mode === 'avp') {\n    return '@webspatial/react-sdk/default'\n  }\n  return '@webspatial/react-sdk/web'\n}\n\nexport function getDefineByMode(mode?: ModeKind) {\n  if (mode === 'avp') {\n    return {\n      'window.XR_ENV': JSON.stringify('avp'),\n      'process.env.XR_ENV': JSON.stringify('avp'),\n      'import.meta.env.XR_ENV': JSON.stringify('avp'),\n    }\n  }\n  return {\n    'window.XR_ENV': undefined,\n    'process.env.XR_ENV': undefined,\n    'import.meta.env.XR_ENV': undefined,\n  }\n}\n\nexport function getDefineXrEnvBase(finalBase?: string) {\n  return {\n    __XR_ENV_BASE__: JSON.stringify(finalBase ?? ''),\n  }\n}\n"],"mappings":";AAAA,IAAM,MAAM;AACZ,SAAS,SAAmB;AAC1B,QAAM,MAAM,QAAQ,IAAI;AACxB,SAAO,QAAQ,QAAQ,QAAQ;AACjC;AAMO,SAAS,aACd,UACA,MACA,kBAA0B,mBAC1B;AACA,MAAI,SAAS,OAAO;AAClB,QAAI,aAAa,QAAW;AAC1B,aAAO;AAAA,IACT,OAAO;AACL,aAAO;AAAA,IACT;AAAA,EACF;AAGA,SAAO;AACT;AAEO,SAAS,eACd,aAAiC,QACjC,MACA,kBAA0B,mBAC1B;AACA,MAAI,SAAS,OAAO;AAClB,sBAAkB,iBAAiB,eAAe;AAClD,WAAO,GAAG,UAAU,IAAI,eAAe;AAAA,EACzC;AAGA,SAAO;AACT;AAEO,SAAS,cAAc,OAAgB;AAC5C,MAAI,UAAU,UAAa,MAAM,WAAW,EAAG,QAAO;AACtD,MAAI,MAAM,CAAC,MAAM,IAAK,QAAO,MAAM;AACnC,SAAO;AACT;AAEO,SAAS,iBAAiB,OAAgB;AAC/C,MAAI,UAAU,OAAW,QAAO;AAEhC,MAAI,MAAM;AACV,SAAO,MAAM,MAAM,UAAU,MAAM,GAAG,MAAM,KAAK;AAC/C,WAAO;AAAA,EACT;AACA,SAAO,MAAM,MAAM,GAAG;AACxB;AAEO,SAAS,uBAAuB,MAAiB;AACtD,MAAI,SAAS,OAAO;AAClB,WAAO,EAAE,0BAA0B,gCAAgC;AAAA,EACrE;AACA,SAAO,EAAE,0BAA0B,4BAA4B;AACjE;AAEO,SAAS,kCAAkC,MAAiB;AACjE,MAAI,SAAS,OAAO;AAClB,WAAO;AAAA,MACL,MAAM;AAAA,MACN,aAAa;AAAA,IACf;AAAA,EACF;AACA,SAAO;AAAA,IACL,MAAM;AAAA,IACN,aAAa;AAAA,EACf;AACF;AAEO,SAAS,kBAAkB,MAAiB;AACjD,MAAI,SAAS,OAAO;AAClB,WAAO;AAAA,MACL,yCACE;AAAA,MACF,qCACE;AAAA,IACJ;AAAA,EACF;AACA,SAAO;AAAA,IACL,yCACE;AAAA,IACF,qCACE;AAAA,EACJ;AACF;AAEO,SAAS,yBAAyB,MAAiB;AACxD,MAAI,SAAS,OAAO;AAClB,WAAO;AAAA,EACT;AACA,SAAO;AACT;AAEO,SAAS,gBAAgB,MAAiB;AAC/C,MAAI,SAAS,OAAO;AAClB,WAAO;AAAA,MACL,iBAAiB,KAAK,UAAU,KAAK;AAAA,MACrC,sBAAsB,KAAK,UAAU,KAAK;AAAA,MAC1C,0BAA0B,KAAK,UAAU,KAAK;AAAA,IAChD;AAAA,EACF;AACA,SAAO;AAAA,IACL,iBAAiB;AAAA,IACjB,sBAAsB;AAAA,IACtB,0BAA0B;AAAA,EAC5B;AACF;AAEO,SAAS,mBAAmB,WAAoB;AACrD,SAAO;AAAA,IACL,iBAAiB,KAAK,UAAU,aAAa,EAAE;AAAA,EACjD;AACF;","names":[]}